<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Gravity Effect</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript">
	$(function() {
		var box = $("#box");
		var distance = 500;
		$("#baseline").css({
			top : distance
		});
		gravity(distance, box);

		function gravity(distance, target) {
			//加速度g为0.378pixel/ms2，相当10m/s2
			var g = 0.378, h = distance, vs = 0, initH = distance, i = 0;
			var t = Math.floor(Math.sqrt((2 * h / g)));
			var first = true;
			var timer = setInterval(function() {
				if (i < t) {
					target.css("top", initH + vs * i - 0.5 * g * i * i);
					console.info(target.position().top);
					i++;
				} else {
					if (first) {
						first = false;
						initH = 0;
					}
					target.css("top", initH);
					h = h / 2;
					if (h < 1) {
						clearInterval(timer);
					}
					vs = Math.sqrt(2 * g * h);
					t = Math.floor(2 * Math.sqrt((2 * h / g)));
					i = 0;
				}
			}, 1);
		}
	})
</script>
<style type="text/css">
body {
	position: relative;
	margin: 0;
}

#box {
	width: 100px;
	height: 100px;
	margin: 0 auto;
	position: relative;
	top: 500px;
	background-color: blue;
}

hr {
	margin: 0;
	position: relative;
}
</style>
</head>
<body>
	<div id="box"></div>
	<hr id="baseline" />
</body>
</html>